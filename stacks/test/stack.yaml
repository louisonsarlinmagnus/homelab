################################################################################
# TEST STACK => docker stack deploy -c stacks/test/stack.yaml test
################################################################################

version: '3.8'

services:
  whoami:
    image: traefik/whoami:v1.11.0
    labels:
      wud.tag.include: ^v\d+\.\d+\.\d+$$
    deploy:
      labels:
        sablier.enable: "true"
        sablier.group: whoami
        traefik.enable: "true"
        traefik.swarm.lbswarm: "true"
        traefik.http.routers.whoami.middlewares: whoami@swarm
        traefik.http.services.whoami.loadbalancer.server.port: 80
        traefik.http.routers.whoami.rule: Host(`new.lsarlinmagnus.fr`)
        traefik.http.routers.whoami.entrypoints: websecure
        traefik.http.routers.whoami.tls: "true"
        traefik.http.routers.whoami.tls.certresolver: ovh
        homepage.group: Test
        homepage.name: Whoami
        homepage.icon: traefik.png
        homepage.href: https://new.lsarlinmagnus.fr
    networks:
      - proxy

networks:
  proxy:
    external: true