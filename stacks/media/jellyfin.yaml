################################################################################
# MEDIA STACK => docker compose -f stacks/media/jellyfin.yaml up -d
################################################################################

services:
  jellyfin:
    image: jellyfin/jellyfin:10.11.1
    restart: unless-stopped

    labels:
      traefik.enable: true
      traefik.http.services.jellyfin.loadbalancer.server.port: 8096
      traefik.http.routers.jellyfin.rule: Host(`jellyfin.lsarlinmagnus.fr`)
      traefik.http.routers.jellyfin.entrypoints: websecure
      traefik.http.routers.jellyfin.tls: true
      traefik.http.routers.jellyfin.tls.certresolver: ovh
      wud.tag.include: ^\d+\.\d+\.\d+$$
    environment:
      TZ: Europe/Paris
    volumes:
      - /media/raid/jellyfin/media/audiobooks:/data/audiobooks
      - /media/raid/jellyfin/media/movies:/data/movies
      - /media/raid/jellyfin/media/series:/data/series
      - media_jellyfin_config:/config
    networks:
      - proxy
    devices:
      - /dev/dri/renderD128:/dev/dri/renderD128

volumes:
  media_jellyfin_config:
    external: true

networks:
  proxy:
    external: true